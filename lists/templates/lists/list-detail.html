<!-- inheriting from the base file -->
{% extends 'books/base.html' %}
{% load static %}

{% block content %}
<div class="container mb-4">
    <div class="row">
        <!-- side navbar here -->
        <div class="col-md-3 mt-3">
            <div class="card">
                <h4 class="card-header px-3">Menu</h4>
                <ul class="list-group list-group-light list-group-small">
                    <li class="list-group-item px-3"><a href="{% url 'home' %}">Home</a></li>
                    <li class="list-group-item px-3"><a href="{% url 'statistics' %}">Statistics</a></li>
                    <li class="list-group-item px-3"><a href="{% url 'profile' %}">Profile</a></li>
                    <li class="list-group-item px-3"><a href="{% url 'my-lists' %}">My Lists</a></li>
                </ul>
            </div>
        </div>
        
        <div class="col-md-9 mt-3">
            <div class="mb-3 d-flex justify-content-between align-items-center">
                <h2 class="mb-0">{{ user_list.name }}</h2>
                <div>
                    <!-- Send the list id to the add-books URL -->
                    <a href="{% url 'add-books' user_list.id %}" class="btn btn-primary btn-sm me-2">Add Books</a>
                    <a href="{% url 'edit-list' user_list.id %}" class="btn btn-secondary btn-sm me-2">Edit List Name</a>
                    <!-- Send the list id to the remove-books URL -->
                    <a href="{% url 'remove-books' user_list.id %}" class="btn btn-danger btn-sm">Remove Books</a>
                </div>
            </div>
            <hr class="my-4">

            <!-- using a for loop to loop through all the books -->
             <div class="row">
             {% for book in books %}
             <div class="col-md-4">
                <div class="card my-2" style="height: 550px;">
                    <a href="{% url 'book-detail' book.id %}">
                        <!-- this is the book image -->
                        {% if book.image %}
                        <img src="{{ book.image.url }}" class="card-img-top"
                            style="width:100%; height:auto; max-height:325px;" />
                        {% else %}
                        <!-- Display placeholder image if no book cover was uploaded -->
                        <img src="/static/images/placeholder.png" class="card-img-top" style="height:325px;" />
                        {% endif %}
                    </a>
                    <div class="card-body"
                        style="display: flex; flex-direction: column; justify-content: space-between;">
                        <div>
                            <!-- Limits the title to 2 lines with ellipsis if it is too long using webkit-line-clamp -->
                            <h4 class="card-text"
                                style="overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical;">
                                {{ book.title }}
                            </h4>
                            <p class="text-muted"><small>by <u>{{book.author}}</u></small></p>
                            <h5>{{book.get_star_display}}</h5>
                        </div>
                        <a href="{% url 'book-detail' book.id %}" class="m-2 btn btn-outline-dark btn-sm">View
                            Book</a>
                    </div>
                </div>
            </div>
            <!-- If there are no books that match the filters display an alert letting the user know -->
            {% empty %}
            <div class="col-12">
                <div class="alert alert-info text-center" role="alert">
                    <h5>No books yet in this list</h5>
                    <p>Try adding a book to your list. <a href="#">Add book</a></p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}