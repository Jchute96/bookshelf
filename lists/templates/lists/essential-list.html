<!-- inheriting from the base file -->
{% extends 'books/base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4 mb-4">
    <div class="row">
        <!-- Left sidebar with list actions -->
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h4 class="mb-3">List Actions</h4>
                    
                    <!-- Export Section (only action for essential lists) -->
                    <div>
                        <h6 class="text-muted mb-2">Export</h6>
                        {% if status == 'finished' %}
                            <a href="{% url 'export-finished' 'csv' %}" class="btn btn-outline-secondary btn-sm w-100 mb-2">Export CSV</a>
                            <a href="{% url 'export-finished' 'pdf' %}" class="btn btn-outline-secondary btn-sm w-100">Export PDF</a>
                        {% elif status == 'currently_reading' %}
                            <a href="{% url 'export-currently-reading' 'csv' %}" class="btn btn-outline-secondary btn-sm w-100 mb-2">Export CSV</a>
                            <a href="{% url 'export-currently-reading' 'pdf' %}" class="btn btn-outline-secondary btn-sm w-100">Export PDF</a>
                        {% elif status == 'want_to_read' %}
                            <a href="{% url 'export-want-to-read' 'csv' %}" class="btn btn-outline-secondary btn-sm w-100 mb-2">Export CSV</a>
                            <a href="{% url 'export-want-to-read' 'pdf' %}" class="btn btn-outline-secondary btn-sm w-100">Export PDF</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Book grid -->
        <div class="col-md-9">
            <h2 class="mb-3">{{ list_name }}</h2>
            <hr class="my-4">

            <!-- using a for loop to loop through all the books -->
            <div class="row">
                {% for book in books %}
                <div class="col-md-4">
                    <div class="card my-2" style="height: 550px;">
                        <a href="{% url 'book-detail' book.id %}">
                            <!-- this is the book image -->
                            {% if book.image %}
                            <img src="{{ book.image.url }}" class="card-img-top"
                                style="width:100%; height:auto; max-height:325px;" />
                            {% else %}
                            <!-- Display placeholder image if no book cover was uploaded -->
                            <img src="/static/images/placeholder.png" class="card-img-top" style="height:325px;" />
                            {% endif %}
                        </a>
                        <div class="card-body"
                            style="display: flex; flex-direction: column; justify-content: space-between;">
                            <div>
                                <!-- Limits the title to 2 lines with ellipsis if it is too long using webkit-line-clamp -->
                                <h4 class="card-text"
                                    style="overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical;">
                                    {{ book.title }}
                                </h4>
                                <p class="text-muted"><small>by <u>{{book.author}}</u></small></p>
                                <h5>{{book.get_star_display}}</h5>
                            </div>
                            <a href="{% url 'book-detail' book.id %}" class="m-2 btn btn-outline-primary btn-sm">View Book</a>
                        </div>
                    </div>
                </div>
                <!-- If there are no books that match the filters display an alert letting the user know -->
                {% empty %}
                <div class="col-12">
                    <div class="alert alert-info text-center" role="alert">
                        <h5>No books yet in this list</h5>
                        <p>Try updating the status of one of your books to add it to this list.</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}